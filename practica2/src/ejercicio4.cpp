
#include "funciones.hpp"

#include <iostream>
#include <boost/dynamic_bitset.hpp>

//
// 1 + x^4: 1001 -> irreducible: longitud maxima = 2^4 - 1 = 15
// 1 + x^2 + x^5: 10010 -> irreducible: longitud maxima = 2^5 - 1 = 31
// 1 + x^6: 100001 -> irreducible: longitud maxima = 2^6 - 1 = 63
//
// estos tres ejemplos los hemos comprobado en el ejercicio 2
// el mcm(15, 31, 63) = 9765
// así que ejecutaremos pidiendo una longitud de 9765 * 2 = 19530
// el resultado, dividido por la mitad para verlo más claro, es el siguiente
// que como podemos ver ambas mitades son iguales (seleccionar con cualquier editor
// de texto que resalte texto que es igual)
// Resultado:
// 011011101101011101010001010111110010011000011000011101101111100011001101101101011011001011101011001010000000001001001101101010001011101101011001100001101010001100011000011001010111101011111010011101111001001110001011010000100111001000000011111011000100011001101001000101110011001110111101011000010110101111001010110111011101101111001110001001111000110011000011101011101000011111011011101101101011111000111100010000010010101011011000111001110001011101101001001100111011011011100011101010000010111101010010011011101011001001111101011100000100111011011000011101101011110011001001001001001101001001010110101011001000000101011101000110011011101000101001011001010111010110011000110001011011001110110011001000111001011000000011100010001000101110011001110101011110001010111101001001010111111010011100111001010001001111101010110010011101001001000111101011110000101101010011000111101001010110011101111101000111101011001110111101011000000111011011101010110111011001100111101010001011111000011001000111100011101101010111011011001111101001011000011100011000001001101000001011101011110001000101101011001100011011011001000111001011001010111101010011001111101011001001110101011100000111011011000000011101101011100111111111001000101111001001010110100011001010110111011101000111001011001001011001110001010111111000001000011101011111101111100011011000101101001010000011101011100000110001010001111101001011011000111101001001110011111010000100111100010000011111101011101011111101111001001110101011011010111101001011000011101001000000011101001001001101111011001100010101011001000010011011101010110001011101000001001110001001110011011011000110100011101000011110011001100111001001011000111110011001010101011000001010111100111001011111101001001100111001110001000011000010000010111101010101000011101101001001111101011111000100101000010000011101111010000111001111101001101101001011100111101011001010010111011001010111111011001001001001011001011111100111001000010101011011001011101011011100101001001000001011101010000011100011010001100101101010001001111101001001010101001011011000011000010001001111101011010001111101101001000111001011000000110001000011000111111111001110111011101101000111100001001010110100011001000111001111001000111001011101000011101010001000111111101011000111100011111000110100011011100111101011110000111101010100011101001001011100111011011011011111101011001110111111010010000011000011001011111101011100001011101111001001111101011011010100001001000000011101001000010111011111001000001101011001100010100011001010100001011101010111011011001001111001011001001110110101001000011000011001100010100011011100101101011001000111111010100010110100001001011111110010011001111101001001000011001110010000011101010001000111101011110001111101011001000110101011010010110101011010000111101111000110111001001001000111111001011110010101011000010111111011001010111001011101101111101111001001110111111011000011101011011100010100011001001101101001000001111111010001000000101010001101111010011001010101101011001010001011110011000111001011000001111101011100000011101011001000110001011011000101111011001000111111101000010111101101001001111110001011100111101011001000011001111101010111111011101000001101111001001111100010011000110100011011100010101011011000111001011100001111101011000000111011001011111111111010001010111101011001010001001011001100111100011000001111101011011011011101101001000110001011000000101101000000000111111111001100011101011101001011110001001010110101011001010001011111001000110011011001001101101111001000111010011001000010000011011100111110011001100101001001100000111100011001011110110000011101111001110001001111101011001010011111010001000011101011000001111101010111000111101001001000110101011110000110001010000000111101001010100111011001101001011111011001110111100011000010001001011101010111101011101101001101111001011111101101011000010000011001001011101011001001101001011001000011101010101001010010001001010101001011011010101101011001000111011011010000111100011000000111101011000000011101101001000111101011001010101011000000000111101101001010111111001101001111101001001000011100011000010011111011101000111111011101101101101010001000110100000011000010101011111000110101011001101101001001010000111111011101011010111010001110111110010011011101101011001110111101111000100011101011001011111101011011010011101001001001111101011000010100011010001000011101011001100011011001101000101101011011010011100011001000110011011001000110111011101000011001011001000110000100011000111100011001100111111011001000111101001001001111110010101001111001000001001111000110011010111101001001000001111111010100111100010001000111101010010010011101111001000110001011100010101001001010000111111001011110011111011001000111110011011010011100011001010111101111101000110111011001001011101111001010110000001001000011101011001001110111011001100101101011101001011110011101010100001011011010101010110011001111101011001000101111111000000011000011000000111101010011000111101111001000111001011100010110101001001000111111001011100111001101001001011100011011010011101011001000001111111101000111101011101000101101010001010110101111011000110001011101101111101011011100111001001111001011111010000010111110010011011101000011001011111101011001100001111111011000011101011001010111101011000001011101001001001110001011001000100101010001000011111001001010111001011101000001110011011000110101011000000100111111101000111011011001100011001110001000111110111001000111001011101000110100011001001111101001111001111101010001001011000010011010111111010001000101101001001100101101010011000111100010000010111101011110000111101111001001111001011010000111011001011000011111011000110111111011001001001100011001110111100011000000000111111001010111101011001100001001011001001111101000001000110001011001100010101011001101111001001101000111101011101010001010010011001111011011011001101101001001000011011011000100011000010001000111101011001010111101101001000110101011001010110111000011000111101101001000011001111101000011111001001000011101011000000101101011101000110101011001100011101111001000110001110001000111001011011100111111011011101111101011000000111110010000011001000011001111111100111001001101101011001010011101111011100011000011000001111101010000011111101111001000110101011101000110011001001000111101011011010011011111001001111111011011000110100011000000011011011001000110001011001100101101111001010111011100001000110100011001001110110011011101111001001001001011100010100010011111000001000101111111011001101101011001000101101010010100011101011000000111101010100011111101001001000111001011111010110111010000000111111011010010011001011101001111100011001100010101011001010011101111001010110001011001001001101010001011110011110001000010101011101101010110011001000101001011111000011110010001001110011011011001101110111001000111101011001100011001110011100111100011001010111101010100010111101101001001110101011111000111001000001000011101111010010011111001101000001111001011100111100011001000100101011001010110101011101000111001110001011111001001011000111001011111101010111011001100111101011010001011100011101011111100011001101101111111011011111101001001110001001011000000011101010000011111101010001000011101011001001110001011101010100001011011000011111111011000111011011001001101110001001000011100011000000010001111001000111111011001100101001110001010110100101001000110100011111101111101011001001111001011110000011111010101000001111001011101101100010011000101101001001110011101111010000111001010000011111101011010000111101001001001110101011000010111111010010000011101011001110111101111101001001111011011010011101011001010000001011001000111101011001001101001110001000110101010001000010000011101000110101011011000101001011011001111111011000001100110001001000111010011001000111101001001100101111111001100111001010000010111101011001011111101001001001111001011001000111001010010000011111001001000011111101101001101100011011000110100011000010010101111101000110001011101101101001011001000111011001011000010101011001100111110011011001101001011101001111100011100001000111011011011111101111011010101101001001000001101010000000111001010001000111101010101001011101001001000110001011111010101011010011000111111011010000111111101101000011110011001100010100011001000101111111001010111011011101000111101111001011110110000011000111001011001001011100011011000111101001101000011111011100001101100010011000101100010011010111101011001000111001110000100111001011000000111101011111011011101011001000111101011010010101001011001000111101111000100011111111001001011101001011110010100011000000001101011001010110011011001100001101010001001110010001001000110001011111000011110011011001111001011010001111110011100000011010011001100111000110011000101101011001110101011110000000111100011001011111101010111001111101101001001111001011110010111111000001000011111101010100111101011101000101100001011110010101011000000110001111101010111001011001100111001011001011110111010001000111100011011001011100011001101111101011100001011111011001011011101001011110101000011001001101101001001010101011110001100011101010001001111101011101010111101011001000111001011011000110011011010000111111101000000011011011001000011100001011100111100011001010101011111101010110101011001001111101010001001111001100001000011000011111000011111011001000101101001110001111100010101000100100000011110111101111011000111101011001110101001011010100111001011001011111101010000010111101011001001111001011101010111101011000000011111111011010011101101001000001100001001000011101011000010100011111001000110101011101101011001011001010110001011011000011000011011001110111011011001101101001100000011110011000000010000000011100101110111001010101101001001010111101111001000111100010001001111101010001001011101111001000111101011101000101111001010000111101011011000111101001001000011101011011000110101011000010101001011001000111
//
// 011011101101011101010001010111110010011000011000011101101111100011001101101101011011001011101011001010000000001001001101101010001011101101011001100001101010001100011000011001010111101011111010011101111001001110001011010000100111001000000011111011000100011001101001000101110011001110111101011000010110101111001010110111011101101111001110001001111000110011000011101011101000011111011011101101101011111000111100010000010010101011011000111001110001011101101001001100111011011011100011101010000010111101010010011011101011001001111101011100000100111011011000011101101011110011001001001001001101001001010110101011001000000101011101000110011011101000101001011001010111010110011000110001011011001110110011001000111001011000000011100010001000101110011001110101011110001010111101001001010111111010011100111001010001001111101010110010011101001001000111101011110000101101010011000111101001010110011101111101000111101011001110111101011000000111011011101010110111011001100111101010001011111000011001000111100011101101010111011011001111101001011000011100011000001001101000001011101011110001000101101011001100011011011001000111001011001010111101010011001111101011001001110101011100000111011011000000011101101011100111111111001000101111001001010110100011001010110111011101000111001011001001011001110001010111111000001000011101011111101111100011011000101101001010000011101011100000110001010001111101001011011000111101001001110011111010000100111100010000011111101011101011111101111001001110101011011010111101001011000011101001000000011101001001001101111011001100010101011001000010011011101010110001011101000001001110001001110011011011000110100011101000011110011001100111001001011000111110011001010101011000001010111100111001011111101001001100111001110001000011000010000010111101010101000011101101001001111101011111000100101000010000011101111010000111001111101001101101001011100111101011001010010111011001010111111011001001001001011001011111100111001000010101011011001011101011011100101001001000001011101010000011100011010001100101101010001001111101001001010101001011011000011000010001001111101011010001111101101001000111001011000000110001000011000111111111001110111011101101000111100001001010110100011001000111001111001000111001011101000011101010001000111111101011000111100011111000110100011011100111101011110000111101010100011101001001011100111011011011011111101011001110111111010010000011000011001011111101011100001011101111001001111101011011010100001001000000011101001000010111011111001000001101011001100010100011001010100001011101010111011011001001111001011001001110110101001000011000011001100010100011011100101101011001000111111010100010110100001001011111110010011001111101001001000011001110010000011101010001000111101011110001111101011001000110101011010010110101011010000111101111000110111001001001000111111001011110010101011000010111111011001010111001011101101111101111001001110111111011000011101011011100010100011001001101101001000001111111010001000000101010001101111010011001010101101011001010001011110011000111001011000001111101011100000011101011001000110001011011000101111011001000111111101000010111101101001001111110001011100111101011001000011001111101010111111011101000001101111001001111100010011000110100011011100010101011011000111001011100001111101011000000111011001011111111111010001010111101011001010001001011001100111100011000001111101011011011011101101001000110001011000000101101000000000111111111001100011101011101001011110001001010110101011001010001011111001000110011011001001101101111001000111010011001000010000011011100111110011001100101001001100000111100011001011110110000011101111001110001001111101011001010011111010001000011101011000001111101010111000111101001001000110101011110000110001010000000111101001010100111011001101001011111011001110111100011000010001001011101010111101011101101001101111001011111101101011000010000011001001011101011001001101001011001000011101010101001010010001001010101001011011010101101011001000111011011010000111100011000000111101011000000011101101001000111101011001010101011000000000111101101001010111111001101001111101001001000011100011000010011111011101000111111011101101101101010001000110100000011000010101011111000110101011001101101001001010000111111011101011010111010001110111110010011011101101011001110111101111000100011101011001011111101011011010011101001001001111101011000010100011010001000011101011001100011011001101000101101011011010011100011001000110011011001000110111011101000011001011001000110000100011000111100011001100111111011001000111101001001001111110010101001111001000001001111000110011010111101001001000001111111010100111100010001000111101010010010011101111001000110001011100010101001001010000111111001011110011111011001000111110011011010011100011001010111101111101000110111011001001011101111001010110000001001000011101011001001110111011001100101101011101001011110011101010100001011011010101010110011001111101011001000101111111000000011000011000000111101010011000111101111001000111001011100010110101001001000111111001011100111001101001001011100011011010011101011001000001111111101000111101011101000101101010001010110101111011000110001011101101111101011011100111001001111001011111010000010111110010011011101000011001011111101011001100001111111011000011101011001010111101011000001011101001001001110001011001000100101010001000011111001001010111001011101000001110011011000110101011000000100111111101000111011011001100011001110001000111110111001000111001011101000110100011001001111101001111001111101010001001011000010011010111111010001000101101001001100101101010011000111100010000010111101011110000111101111001001111001011010000111011001011000011111011000110111111011001001001100011001110111100011000000000111111001010111101011001100001001011001001111101000001000110001011001100010101011001101111001001101000111101011101010001010010011001111011011011001101101001001000011011011000100011000010001000111101011001010111101101001000110101011001010110111000011000111101101001000011001111101000011111001001000011101011000000101101011101000110101011001100011101111001000110001110001000111001011011100111111011011101111101011000000111110010000011001000011001111111100111001001101101011001010011101111011100011000011000001111101010000011111101111001000110101011101000110011001001000111101011011010011011111001001111111011011000110100011000000011011011001000110001011001100101101111001010111011100001000110100011001001110110011011101111001001001001011100010100010011111000001000101111111011001101101011001000101101010010100011101011000000111101010100011111101001001000111001011111010110111010000000111111011010010011001011101001111100011001100010101011001010011101111001010110001011001001001101010001011110011110001000010101011101101010110011001000101001011111000011110010001001110011011011001101110111001000111101011001100011001110011100111100011001010111101010100010111101101001001110101011111000111001000001000011101111010010011111001101000001111001011100111100011001000100101011001010110101011101000111001110001011111001001011000111001011111101010111011001100111101011010001011100011101011111100011001101101111111011011111101001001110001001011000000011101010000011111101010001000011101011001001110001011101010100001011011000011111111011000111011011001001101110001001000011100011000000010001111001000111111011001100101001110001010110100101001000110100011111101111101011001001111001011110000011111010101000001111001011101101100010011000101101001001110011101111010000111001010000011111101011010000111101001001001110101011000010111111010010000011101011001110111101111101001001111011011010011101011001010000001011001000111101011001001101001110001000110101010001000010000011101000110101011011000101001011011001111111011000001100110001001000111010011001000111101001001100101111111001100111001010000010111101011001011111101001001001111001011001000111001010010000011111001001000011111101101001101100011011000110100011000010010101111101000110001011101101101001011001000111011001011000010101011001100111110011011001101001011101001111100011100001000111011011011111101111011010101101001001000001101010000000111001010001000111101010101001011101001001000110001011111010101011010011000111111011010000111111101101000011110011001100010100011001000101111111001010111011011101000111101111001011110110000011000111001011001001011100011011000111101001101000011111011100001101100010011000101100010011010111101011001000111001110000100111001011000000111101011111011011101011001000111101011010010101001011001000111101111000100011111111001001011101001011110010100011000000001101011001010110011011001100001101010001001110010001001000110001011111000011110011011001111001011010001111110011100000011010011001100111000110011000101101011001110101011110000000111100011001011111101010111001111101101001001111001011110010111111000001000011111101010100111101011101000101100001011110010101011000000110001111101010111001011001100111001011001011110111010001000111100011011001011100011001101111101011100001011111011001011011101001011110101000011001001101101001001010101011110001100011101010001001111101011101010111101011001000111001011011000110011011010000111111101000000011011011001000011100001011100111100011001010101011111101010110101011001001111101010001001111001100001000011000011111000011111011001000101101001110001111100010101000100100000011110111101111011000111101011001110101001011010100111001011001011111101010000010111101011001001111001011101010111101011000000011111111011010011101101001000001100001001000011101011000010100011111001000110101011101101011001011001010110001011011000011000011011001110111011011001101101001100000011110011000000010000000011100101110111001010101101001001010111101111001000111100010001001111101010001001011101111001000111101011101000101111001010000111101011011000111101001001000011101011011000110101011000010101001011001000111


int main ( int argc, char ** argv) {

	if ( argc != 8 ) {
		std::cerr << "ERROR: Numero de argumentos erroneos.\n"
					 << "\t Uso: " << argv[0] << " <p1> <semilla1> <p2> <semilla2> <p3> <semilla3> <longitud>" << std::endl;
		exit(-1);
	}

	std::string coeficientes_p1 = std::string(argv[1]);
	std::string semilla1 = std::string(argv[2]);
	std::string coeficientes_p2 = std::string(argv[3]);
	std::string semilla2 = std::string(argv[4]);
	std::string coeficientes_p3 = std::string(argv[5]);
	std::string semilla3 = std::string(argv[6]);

	int longitud = atoi(argv[7]);

	if ( coeficientes_p1.size() != semilla1.size() || coeficientes_p2.size() != semilla2.size() || coeficientes_p3.size() != semilla3.size()) {
		std::cerr << "ERROR: La longitud del string de coeficientes y de la semilla ha de ser la misma en cada pareja" << std::endl;
		exit(-2);
	}

	std::pair<boost::dynamic_bitset<>, boost::dynamic_bitset<> > lfsr1;
	std::pair<boost::dynamic_bitset<>, boost::dynamic_bitset<> > lfsr2;
	std::pair<boost::dynamic_bitset<>, boost::dynamic_bitset<> > lfsr3;

	lfsr1 = std::make_pair(boost::dynamic_bitset<>(coeficientes_p1), boost::dynamic_bitset<>(semilla1));
	lfsr2 = std::make_pair(boost::dynamic_bitset<>(coeficientes_p2), boost::dynamic_bitset<>(semilla2));
	lfsr3 = std::make_pair(boost::dynamic_bitset<>(coeficientes_p3), boost::dynamic_bitset<>(semilla3));

	auto resultado = generador_geffe(lfsr1, lfsr2, lfsr3, longitud);


	std::cout << "Resultado: " << std::endl;
	std::cout << resultado << std::endl;

	// tienen periodo su mcm si los tres polinomios son primos relativos

}
